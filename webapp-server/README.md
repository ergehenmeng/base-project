## 业务说明

### 商户相关

* 商户创建或编辑时,可以选择商户可以经营的品类, 例如: 门票, 民宿等. 具体品类在 `ProductType` 定义中定义
* 商户所能经营的品类和角色有关联关系, 具体在 `RoleMapping` 中映射
* 商户创建时,默认会创建商户管理员用户, 该用户具有商户管理权限, 同时平台有权对其的账户进行管理: 锁定, 解锁, 重置密码,
  调整费率, 导出, 解绑(用于绑定微信号进行通知或提现等操作)
* 商户同样可以自己进行绑定微信号(移动端)或更换微信号, 用于通知或提现等操作
* 商户可以创建自己的用户或角色, 用来管理自己的店铺等

### 活动日历相关

* 活动主要用在景区上, 目前是单独的一个模块
* 景区详情默认会显示最近7天(系统参数控制)的活动日历
* 由于景区可能每天都有一样的活动, 列表展示可能有重复的, 因此建议按前端展示时按日期进行分组

### 留言相关

* 目前只支持新闻类资讯和景区活动两个模块的评论
* 普通用户可以对评论进行点赞或者举报
* 默认评论直接展示, 但是可以对评论进行屏蔽, 置顶, 取消置顶
* 如果移动端留言被20人(可以由系统参数配置)举报, 默认自动屏蔽

### 民宿相关

* 商户创建时, 默认会创建一个民宿店铺, 商户可以对民宿店铺进行编辑, 上下架,删除等操作
* 民宿是商户经营的类型, 有编辑, 上下架, 删除等操作, 平台也可以对其强制下架(强制下架的民宿不会在允许上架)
* 民宿下面有房型, 有新增, 编辑, 上下架, 删除, 推荐房型(用于展示在民宿首页)等操作
* 房型有价格日历可以配置
* 用户下完民宿订单后, 如果设置的是手动确认是否有房时, 需要商户后台审核, 审核通过才可入住, 如果审核无房, 则退款

### 零售相关

* 商户创建时, 默认会生成一个零售店铺, 商户可以对零售店铺进行编辑, 上下架, 删除等操作
* 零售有新增, 编辑, 上下架, 删除, 推荐商品, 排序等操作
* 由于零售有物流, 因此同样有快递模板管理
* 零售标签管理(平台用户统一维护)
* 零售除了正常的订单, 还可以参与拼团,限时购
* 零售是唯一支持购物车的品类
* 零售订单有发货, 退款, 更新快递单号

### 线路相关

* 商户创建时, 默认会生成一个旅行社, 商户可以对旅行社进行编辑, 上下架, 删除等操作
* 线路有新增, 编辑, 上下架, 删除, 排序等操作, 线路可以根据配置的天数配置每一天的活动
* 线路订单

### 积分相关

* 积分是平台账户的虚拟币, 用于抵扣商品价格, 同时商户自己也可以通过抽奖等给用户发放积分, 也可以通过订单支付收取积分(
  用户支付的积分)
* 商户积分可以充值, 同样可以提现, 注意: 充值方式有两种(余额充值, 微信或支付宝充值), 提现只能提现到商户余额
* 积分提现时不会额外生成积分提现记录, 只有积分变动记录
* 积分充值时同样只有积分变动记录, 没有充值记录

### 资金账户相关

* 商户资金余额包含: 可用余额 + 冻结金额(支付冻结)
* 所有涉及上述两项金额变动均的操作均需要添加资金记录 `account_log`
* 订单支付时, 额外会增加资金冻结记录
* 订单退款时, 会更新资金冻结记录
* 商户提现时, 额外增加提现记录

### 营销活动相关

#### 优惠券

* 优惠券可以是满减券或折扣券
* 注意: 优惠券编辑时, 不能修改使用范围,使用时间,金额,优惠金额等
* 优惠券所使用的范围: 支持除零售(待开发)之外的所有品类
* 优惠券可以手动发放给指定的人员, 也可以通过通过领券中心让用户自己领取
* 目前只支持商户优惠券, 不支持平台优惠券, 且使用范围为: 店铺(零售店铺)或指定商品(所有商品)
* 零售商品详情页会展示可以领取的优惠券
* 支持优惠券的品类: 全部

#### 拼团

* 拼团只能是单个商品(零售), 不支持阶梯价格优惠的拼团设置
* 在拼团有效期结束时, 所有没有拼团成功的订单会自动取消
* 未成团之前,如果团长取消订单, 所有参团的订单都会自动取消
* 成团后订单取消, 不会取消其他人的订单(团长也一样)

#### 限时购

* 限时购支持多个商品(零售)

#### cdKey

* 兑换码配置生成后, 需要手动生成cdKey, 且只能生成一次, 通过导出cdKey让运营人员使用
* 兑换码支持民宿, 餐饮券, 线路, 场馆四类商品
* 退款时兑换码不会自动退回
* cdKey属于平台优惠, 因此其使用范围需要线下跟对应商户或门店进行沟通,方便结算
* 默认情况下, 兑换码只能在指定的门店使用, 如需在指定商品使用, 可以设置系统参数 `redeem_code_scope`;
* 支持兑换码的品类: 民宿, 线路, 场馆(只要涉及部分退的商品均不支持兑换码)

#### 抽奖相关

* 抽奖活动只试用于零售店铺, 可以指定某个店铺,也可以指定一个商户下的所有店铺
* 

### 其他说明

* 零售, 民宿, 餐饮, 旅行社类商户在注册时只生成一个店铺, 但是可以创建多个商品(需要平台账户创建)
* 支持零元购的品类: 门票, 场馆 
