<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eghm.mapper.MemberAddressMapper">

    <select id="getByMemberId" resultType="com.eghm.model.MemberAddress">
        select
        id, member_id, state, province_id, province_name, city_id, city_name, county_id, county_name, detail_address
        from member_address where member_id = #{memberId} and deleted = false order by state, update_time desc
    </select>

    <update id="updateState">
        update member_address
        set state = #{state}
        where member_id = #{memberId}
    </update>

    <update id="updateByMemberId" parameterType="com.eghm.model.MemberAddress">
        update member_address
        <set>
            <if test="state != null">
                state = #{state,jdbcType=TINYINT},
            </if>
            <if test="provinceId != null">
                province_id = #{provinceId,jdbcType=BIGINT},
            </if>
            <if test="provinceName != null">
                province_name = #{provinceName,jdbcType=VARCHAR},
            </if>
            <if test="cityId != null">
                city_id = #{cityId,jdbcType=BIGINT},
            </if>
            <if test="cityName != null">
                city_name = #{cityName,jdbcType=VARCHAR},
            </if>
            <if test="countyId != null">
                county_id = #{countyId,jdbcType=BIGINT},
            </if>
            <if test="countyName != null">
                county_name = #{countyName,jdbcType=VARCHAR},
            </if>
            <if test="detailAddress != null">
                detail_address = #{detailAddress,jdbcType=VARCHAR},
            </if>
        </set>
        where id = #{id} and member_id = #{memberId}
    </update>

</mapper>