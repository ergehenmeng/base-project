<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eghm.mapper.ShoppingCartMapper">

    <select id="getList" resultType="com.eghm.model.vo.shopping.ShoppingCartItemVO">
        select
        t.id,
        t.store_id as storeId,
        m.title as storeTitle,
        ifnull(ps.cover_url, r.cover_url) as coverUrl,
        r.title,
        t.quantity,
        ps.sale_price as salePrice,
        t.sale_price as rawSalePrice,
        r.quota as quota,
        ps.title as skuName,
        ps.stock,
        ps.deleted as skuState,
        r.audit_state as productState
        from shopping_cart t
        left join item_store m on t.store_id = m.id
        left join item r on t.item_id = r.id
        left join item_sku ps on t.sku_id = ps.id
        where t.deleted = false and t.user_id = #{userId} order by t.id desc
    </select>

</mapper>
